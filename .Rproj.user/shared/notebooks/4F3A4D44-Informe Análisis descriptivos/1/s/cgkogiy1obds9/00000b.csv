"0","p2_aux <- empresa4 %>%"
"0","  count(contratista) %>%"
"0","  arrange(desc(contratista)) %>%"
"0","  mutate(prop = round(n*100/sum(n), digits = 1),"
"0","         lab.ypos = cumsum(prop) - 0.5*prop)"
"0",""
"0","p2_aux$label <- paste0(round(p2_aux$prop), ""%"", "
"0","                        ""\n("", p2_aux$n, "")"")"
"0",""
"0","p2 <- ggplot(p2_aux, "
"0","               aes(x = """", "
"0","                   y = prop, "
"0","                   fill = contratista)) +"
"0","  geom_bar(width = 1, "
"0","           stat = ""identity"", "
"0","           color = ""black"") +"
"0","  geom_text(aes(y = lab.ypos, label = label), "
"0","            color = ""black"", "
"0","            size = 3.5) +"
"0","  coord_polar(""y"", "
"0","              start = 0, "
"0","              direction = -1) +"
"0","  scale_fill_manual(values = c(""#2171B5"",""#BDD7E7"")) +"
"0","  theme_void() +"
"0","  labs(fill = """","
"0","       caption = ""Nota: n entre parÃ©ntesis"")"
"0",""
"0","p2"
