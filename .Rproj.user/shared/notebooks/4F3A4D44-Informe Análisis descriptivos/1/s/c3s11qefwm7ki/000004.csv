"0","p3_aux<- df %>% "
"0","  group_by(empresa, nivel_educativo) %>% "
"0","  summarize(n = n()) %>% "
"0","  mutate(pct = n/sum(n),"
"0","         lbl = percent(pct), "
"0","         var_lbl = paste0(lbl, "" ("", n, "")""))"
"2","`summarise()` has grouped output by 'empresa'. You can override using the `.groups` argument.
"
"0","p_item <- ggplot(p3_aux, aes(x = empresa, "
"0","                                 y = pct, "
"0","                                 fill = nivel_educativo)) + "
"0","  geom_bar(stat = ""identity"","
"0","           position = ""fill"", "
"0","           color = ""black"") +"
"0","  scale_y_continuous(breaks = seq(0, 1, .2), "
"0","                     label = percent) +"
"0","  geom_text(aes(label = var_lbl), "
"0","            size = 3.1,"
"0","            position = position_stack(vjust = 0.5)) + "
"0","  labs(y = """", "
"0","       x = """","
"0","       fill = ""Nivel educativo"", "
"0","       caption = ""Nota: N de cada categorÃ­a entre parÃ©ntesis"") +"
"0","  scale_fill_manual(values = c(""#2171B5"",""#6BAED6"",""#BDD7E7"", ""#EFF3FF"")) +"
"0","  theme_minimal()"
"0",""
"0","p_item"
